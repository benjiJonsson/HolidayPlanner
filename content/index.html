<!DOCTYPE html>
<html>

<head>
  <title>CS5003 Group T</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="stylesheet" href="style.css" />
  <script src="https://kit.fontawesome.com/0fb65ecdbf.js" crossorigin="anonymous"></script>
  <!-- Leaflet External JS & CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.css" crossorigin="" />
  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.js" crossorigin=""></script>

  <link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
    integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin="" />
  <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
    integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>

  <style>
    html,
    body {
      height: 100%;
      margin: 0;
    }

    .leaflet-container {
      height: 400px;
      width: 600px;
      max-width: 100%;
      max-height: 100%;
    }
  </style>
  <!-- leaflet.js file taken from UNPKG https://unpkg.com/browse/leaflet@1.7.1/dist/ -->
  <!--<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script> -->
</head>

<body>
  <header>
    <h1>HOLIDAY FUN</h1>
    <p><b>Plan your holiday today!</b></p>

    <!-- SD302: Navigation bar -->
    <div id="nav">
      <a href="index.html">Home</a>
      <a href="client-Uploadpost.html"> Upload Post</a>
      <!-- SD302: Navigation bar - category dropdown -->
      <div class="dropdown">
        <button class="dropbtn">Categories
          <i class="fa fa-caret-down"></i>
        </button>
        <div class="dropdown-content">
          <a href="client-BeachPage.html" style="float: none;
          text-decoration: none;
          display: block;
          text-align: left;" id="beachButton">Beach</a>
          <a href="client-FoodPage.html" style="float: none;
          text-decoration: none;
          display: block;
          text-align: left;">Food</a>
          <a href="client-SportPage.html" style="float: none;
          text-decoration: none;
          display: block;
          text-align: left;">Sports</a>
          <a href="client-MuseumPage.html" style="float: none;
          text-decoration: none;
          display: block;
          text-align: left;">Museum</a>
          <a href="client-AttractionsPage.html" style="float: none;
          text-decoration: none;
          display: block;
          text-align: left;">Attractions</a>
        </div>

      </div>
      <a id="login" style="float:right">Log In</a>
      <a href="signup.html" style="float:right">Sign up</a>
      <div class="cards_wrapper" style="display: flex;flex-direction: row; float: left">
        <div>
          <a href="client-BeachPage.html" class="button"><i class="cards fa-solid fa-umbrella-beach fa-xl"></i>Beach</a>
          <a href="client-FoodPage.html" class="button"><i class="cards fa-solid fa-pizza-slice fa-xl"></i> Food</a>
          <a href="client-SportPage.html" class="button"><i class="cards fa-solid fa-ranking-star fa-xl"></i>Sport</a>
          <a href="client-MuseumPage.html" class="button"><i
              class="cards fa-solid fa-building-columns fa-xl"></i>Museum</a>
          <a href="client-AttractionsPage.html" class="button"><i
              class="cards fa-solid fa-sun fa-xl"></i>Attractions</a>
        </div>
        <div style="display: flex; flex-direction: row; float: right">
          <input id="location" placeholder="get the weather by location!" style="outline: 0;border-radius: .5rem;width:fit-content" />
          <button style="margin: 0px .5rem" onclick="queryWeather()">Search</button>
        </div>
      </div>
    </div>
    </div>
  </header>

  <!--add map-->
  <!--  <div id="mapid" style="height: 500px; width: 1000px; margin-left:350px;"></div>-->
  <!--  <script src="location.js"></script>-->
  <!--  <script>-->
  <!--  var mymap = L.map('mapid').setView([51.505, -0.09], 13);-->
  <!--            L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {-->
  <!--                maxZoom: 19,-->
  <!--                attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'-->
  <!--            }).addTo(mymap);-->
  <!--            var marker = L.marker([51.5, -0.09]).addTo(mymap);-->
  <!--            marker.bindPopup("<b>Hello world!</b><br>I am a popup.").openPopup();-->

  <!--            var circle = L.circle([51.508, -0.11], {-->
  <!--                color: 'red',-->
  <!--                fillColor: '#f03',-->
  <!--                fillOpacity: 0.5,-->
  <!--                radius: 500-->
  <!--            }).addTo(mymap);-->

  <!--            function onMapClick(e){-->
  <!--                alert("You clicked the map at" + e.IatIng);-->
  <!--            }-->
  <!--            mymap.on('click', onMapClick);-->
  <!--        </script>-->
  <main class="wrapper">
    <h1 style="text-align: center;">Where do you want to go?</h1>

    <div id="flex-container">
      <div id="map" style="width: 60%; height: 500px; margin-left: 20px; z-index: 1;"></div>


      <div id="itinerary-container" style="margin-left: 10px;">
        <div class="cards_container">
          <button onclick="Activate(event,'options')">
            All Options</button>
          <button onclick="Activate(event,'itinerary')"><i class="cards fa-solid fa-book fa-xl"></i> Your
            Itinerary</button>
        </div>
        <p style="text-align: center;"><b>Explore our categories for your best holiday!</b></p>
        <div id="category_content">
          <div id="options" class="category_cards" style="display:none;">
            <h3> Choose Your Options</h3>
            <section id="mainGridTest beach">
              <div class="postTest 1" id="post1">
                <img src="images/west-sands.jpeg" style="align-items: center; width: 200px;" class="center">
                <p id ="title"> Title: West Sands</p>
                <p id = 'rating'> Rating: 5</p>
                <p id ='type'> Type: Beach</p>
                <p id = "address"> Address:</p>
                <button onclick="getOneEvent()">Print This Activity</button>
              </div>

            </section>
            <div class = "listRandom">

            </div>
                <!-- SD302 + KPF!: destination lists and random events for home page -->

            <script>
            const fetch = new XMLHttpRequest();
            fetch.open = ('GET', '/holidayEvents/5randomEvents/');
              fetch.onload = function() {
                if (fetch.status ==200) {
                  const fiveRand = JSON.parse(fetch.responseText);
                  fiveRand.forEach(function(fiveRand) {
                    const listRandom = document.createElement('li');
                    listRandom.classList.add('fiveRand');
                    listRandom.innerHTML =
                   ` <img src ="${destination.imageUrl}" alt="${destination.name}">
              <h2>${destination.name}</h2>
              <p>Rating: ${destination.rating}</p>
              <p>Type: ${destination.type}</p>
              <p>Address: ${destination.address}</p>
              <button id = "print" onlcick = "getOneEvent()">Print Activity</button>
            `;
            document.getElementsByClassName('listRandom').appendChild(listRand);
                  });
                } else {
                  console.log("Could not get random elements" + fetch.status);
                }
            };
            fetch.send();
          </script>
          </div>
        </div>
      </div>
      <div id="itinerary" class="category_cards" style="display:none;">
        <h3> Choose Your Options</h3>
        <section id="mainGridTest beach">
          <div class="postTest 1" id="post2">
            <img src="images/west-sands.jpeg" style="align-items: center; width: 200px;" class="center">
            <p> Title: West Sands</p>
            <p> Rating: 5</p>
            <p> Type: Beach</p>
            <p> Address:</p>
            <button onclick="getOneEvent()">Print This Activity</button>
          </div>

        </section>
        <div class = "listRandom">

        </div>
        <script>
        const fetch = new XMLHttpRequest();
        fetch.open = ('GET', '/holidayEvents/5randomEvents/');
          fetch.onload = function() {
            if (fetch.status ==200) {
              const fiveRand = JSON.parse(fetch.responseText);
              fiveRand.forEach(function(fiveRand) {
                const listRandom = document.createElement('li');
                listRandom.classList.add('fiveRand');
                listRandom.innerHTML =
               ` <img src ="${destination.imageUrl}" alt="${destination.name}">
          <h2>${destination.name}</h2>
          <p>Rating: ${destination.rating}</p>
          <p>Type: ${destination.type}</p>
          <p>Address: ${destination.address}</p>
          <button id = "print" onlcick = "getOneEve">Print Activity</button>
        `;
        document.getElementsByClassName('listRandom').appendChild(listRand);
              });
            } else {
              console.log("Could not get random elements" + fetch.status);
            }
        };
        fetch.send();
      </script>
    </div>
    <!-- SD302: destinations -->
    <div id="recent-destinations-container">
      <h2>Recent Destinations</h2>
      <p><b>Have a look a the destinations added lately!</b></p>
      <div class="slideshow-container">
        <ul id="destinations-list"></ul>
      </div>
    </div>

    <!-- SD302: MAP -->
    <!--      <div id="map"></div>-->
    <!--      <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDmRL35LLnETxjcaepSDFYOo7wSltkA6uk&callback=initMap"-->
    <!--        async defer></script>-->
    <!--      <script src="location.js"></script>-->

    <!-- <div id="interactive"> -->
    <!-- SD302 + KPF1: Category cards-->
    <!-- KPF1: restructured syntax to avoid repetition
changed icon into item class to avoid excessive code
restructured to be user-friendly with toggling pages in JS function Activate()-->
    <!--
    <div class="cards_wrapper">
      <button onclick="Activate(event,'postPage')"><i class="cards fa-solid fa-book fa-xl"></i> Upload Post</button>
      <br><br>

      <div class="cards_container">
        <button onclick="Activate(event,'Beach')"><i class="cards fa-solid fa-umbrella-beach fa-xl"></i>
          Beach</button>
        <button onclick="Activate(event,'Food')"><i class="cards fa-solid fa-pizza-slice fa-xl"></i> Food</button>
        <button onclick="Activate(event,'Sport')"><i class="cards fa-solid fa-ranking-star fa-xl"></i>
          Sport</button>
        <button onclick="Activate(event,'Museum')"><i class="cards fa-solid fa-building-columns fa-xl"></i>
          Museum</button>
        <button onclick="Activate(event,'Attraction')"><i class="cards fa-solid fa-sun fa-xl"></i>
          Attractions</button>
      </div>
    </div> -->

    <!-- <div id="category_content">
      <div id="Beach" class="category_cards" style="display:none;">
         beach category -->
    <!-- <h3> Let's Go To The Beach</h3>
    <section id="mainGridTest">
      <div class="postTest 1" id="post1">
        <img src="images/west-sands.jpeg" style="align-items: center; width: 200px;" class="center">
        <p> Title: West Sands</p>
        <p> Rating: 5</p>
        <p> Type: Beach</p>
        <p> Address:</p>
      </div>

            </section>
          </div>

          <div id="Food" class="category_cards" style="display:none;"> -->
    <!-- food category -->



    <!-- <div id="Sport" class="category_cards" style="display:none;"> -->
    <!-- sport category -->
    <!-- <h3> Sports!</h3>
          </div>

          <div id="Museum" class="category_cards" style="display:none;"> -->
    <!-- museum category -->
    <!-- <h3>Muse on Over to a Famous St. Andrews Museum</h3>
          </div>


          <div id="Attraction" class="category_cards" style="display:none;"> -->
    <!-- attraction category -->

    <!-- <h3> Law of Attraction(s)</h3>

          </div> -->
    <!-- KPF1: Post Page -->
    <!-- HT61: Move to separate upload page -->
    <!-- <div id="postPage" class="category_cards postPage" style="display:none;">

            <div id="leftPostPage" class="leftPostPage">
              <div class=topIconsPP>
                <p>Enter Post Information Here:</p>
                <input id="titleInput" placeholder="Enter Title">
                </div>
                <div class = "dropdowns">
                <select name="typeDropDown" id="typeDropDown">
                  <option value="">--Select Type--</option>
                  <option value="Beach">Beach</option>
                  <option value="Food">Food</option>
                  <option value="Sport">Sport</option>
                  <option value="Museum">Museum</option>
                  <option value="Attraction">Attraction</option>
                </select>
                <select name="ratingDropDown" id="ratingDropDown">
                  <option value="">--Select Rating--</option>
                  <option value="1 Star">1 Star</option>
                  <option value="2 Stars">2 Stars</option>
                  <option value="3 Stars">3 Stars</option>
                  <option value="4 Stars">4 Stars</option>
                  <option value="5 Stars">5 Stars</option>
                </select>
                 here add adress property -->
    <!-- <input id="adressInput" type="adress" placeholder="Enter adress" />
        </div>
        <div class="transportation">
          <label for transportation>How Did You Get There?</label>
          <input type="checkbox" id="car" name="transportation" value="car"> Car</input>
          <input type="checkbox" id="subway" name="transportation" value="subway">Subway</input>
        </div>
        <textarea id="commentInput" placeholder="Enter Comment"></textarea>

      </div>

      <div id="rightPostPage" class="rightPostPage">
        <div class=imageUploadContainer> -->
    <!-- <form runat="file"> -->
    <!-- <form>
            <input accept="image/*" type="file" id="imageUpload" />
            <img id="userImage" src="#" alt="user image" />
          </form>
        </div>
        <div class="makePostContainer">
          <button id=uploadPost onclick="uploadPost()">Upload Post</button>
          <button id=submitPost onclick="createDiv()">Make Post</button>
          <button id=cancelPost onclick="clearSubmission()">Clear Submission</button>

        </div>
      </div>  -->


    <script src="login&signup.js"></script>
    <script src="itinerary.js"></script>

    <script>

      /* SD302: most recent destinations */
      const hr = new XMLHttpRequest();
      hr.open('GET', '/holidayEvents/recentDate');
      hr.onload = function () {
        if (hr.status === 200) {
          const destinations = JSON.parse(hr.responseText);
          destinations.forEach(function (destination) {
            /*var counter = 1;

            couter++;
            const div = document.createElement("div" + counter);

            div.forEach(function (destination) {*/
            const li = document.createElement('li');
            li.classList.add('destination');
            li.innerHTML =
              `
            <img src ="${destination.imageUrl}" alt="${destination.name}">
            <h2>${destination.name}</h2>
            <p>Rating: ${destination.rating}</p>
            <p>Type: ${destination.type}</p>
            <p>Address: ${destination.address}</p>
            <p>Date Submitted</p>
            `;
            //li.textContent = destination.name;
            document.getElementById('destinations-list').appendChild(li);
            //  })

          });
        } else {
          console.log('Request failed. Returned status of ' + hr.status);
        }
      };

      hr.send();
      /* end of most recent destinations code */

      // connect to weather api
      function queryWeather(address) {
        const apiKey = '2654d06e65bd3dc4726713a79c4254bb';
        // const query = 'St-Andrews';
        const query = document.getElementById("location").value;
        const apiUrl = `http://api.weatherstack.com/current?access_key=${apiKey}&query=${address ? address : query}`;

        fetch(apiUrl)
          .then(response => response.json())
          .then(data => {
            console.log(data)
            const location = data.location.name;
            const temperature = data.current.temperature;
            const description = data.current.weather_descriptions[0];
            window.alert("temperature:" + temperature)
            const weatherInfo = `It is currently ${temperature} degrees Celsius and ${description} in ${location}.`;

          })
          .catch(error => {
            console.error('Error fetching weather data:', error);
          })
      }
    </script>
    <script src="location.js"></script>
    <script>
      var mymap = L.map('mapid').setView([51.505, -0.09], 13);
      L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
      }).addTo(mymap);
      var marker = L.marker([51.5, -0.09]).addTo(mymap);
      marker.bindPopup("<b>Hello world!</b><br>I am a popup.").openPopup();

      var circle = L.circle([51.508, -0.11], {
        color: 'red',
        fillColor: '#f03',
        fillOpacity: 0.5,
        radius: 500
      }).addTo(mymap);
    </script>
    <script>


  /////////* SD302: MAP JAVASCRIPT*/////////

  // MAP CODE ONLY WORKS IN INTERNAL JAVASCRIPT BECAUSE OF THE LEAFLET JS LIBRARY
  // var map = L.map('map').setView([56.341248, -2.794415], 13)

  // add tile layer from OpenStreetMap https://wiki.openstreetmap.org/wiki/Tile_servers
  // L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  //   attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' + '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery <a href="https://www.mapbox.com">Mapbox</a>',
  //   maxZoom: 18,
  // }).addTo(map);

  // // change markers based on each category
  // var beachMarker = new L.Icon({
  //   iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-gold.png',
  //   shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
  //   iconSize: [25, 41],
  //   iconAnchor: [12, 41],
  //   popupAnchor: [1, -34],
  //   shadowSize: [41, 41]
  // });

  // var foodMarker = new L.Icon({
  //   iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',
  //   shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
  //   iconSize: [25, 41],
  //   iconAnchor: [12, 41],
  //   popupAnchor: [1, -34],
  //   shadowSize: [41, 41]
  // });

  // var sportMarker = new L.Icon({
  //   iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png',
  //   shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
  //   iconSize: [25, 41],
  //   iconAnchor: [12, 41],
  //   popupAnchor: [1, -34],
  //   shadowSize: [41, 41]
  // });

  // var museumMarker = new L.Icon({
  //   iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-violet.png',
  //   shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
  //   iconSize: [25, 41],
  //   iconAnchor: [12, 41],
  //   popupAnchor: [1, -34],
  //   shadowSize: [41, 41]
  // });

  // var attracMarker = new L.Icon({
  //   iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png',
  //   shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
  //   iconSize: [25, 41],
  //   iconAnchor: [12, 41],
  //   popupAnchor: [1, -34],
  //   shadowSize: [41, 41]
  // });//

      /* Markers */
  // Marker for St andrews
  //var stAMarker = L.marker([56.341248, -2.794415]).addTo(map).bindPopup("St Andrews")

  // var westSandsMarker = L.marker([56.3556, -2.8087], { icon: beachMarker }).addTo(map).bindPopup("West Sands") // Marker for West sands
  // var eastSandsMarker = L.marker([56.3329, -2.7795], { icon: beachMarker }).addTo(map).bindPopup("East Sands")  // Marker for East sands
  // var castleSandsMarker = L.marker([56.3419, -2.7892], { icon: beachMarker }).addTo(map).bindPopup("Castle Sands")  // Marker for castle sands

  // var adamsonMarker = L.marker([56.3414, -2.7965], { icon: foodMarker }).addTo(map).bindPopup("The Adamson")  // Marker for The Adamson
  // var toastieMarker = L.marker([56.33886, -2.79867], { icon: foodMarker }).addTo(map).bindPopup("Toastie Bar") // Marker for Toastie Bar
  // var forganMarker = L.marker([56.3403, -2.7970], { icon: foodMarker }).addTo(map).bindPopup("Forgan's") // Marker for Toastie Bar

  // var linksMarker = L.marker([56.341056, -2.806228], { icon: sportMarker }).addTo(map).bindPopup("St Andrews Links")  // Marker for St Andrews Links
  // var golfMarker = L.marker([56.339172, -2.794791], { icon: sportMarker }).addTo(map).bindPopup("St Andrews Indoor Golf Centre")  // Marker for St Andrews Indoor Golf

  // var trustMarker = L.marker([56.341056, -2.806228], { icon: museumMarker }).addTo(map).bindPopup("St Andrews Preservation Trust Museum")  // Marker for St Andrews trust
  // var castleMarker = L.marker([56.3414, -2.7954], { icon: museumMarker }).addTo(map).bindPopup("St Andrews Castle")  // Marker for St Andrews castle

  // var aquaMarker = L.marker([56.340678, -2.797846], { icon: attracMarker }).addTo(map).bindPopup("St Andrews Aquarium")  // Marker for St Andrews Aquarium
  // var gardenMarker = L.marker([56.3340, -2.8071], { icon: attracMarker }).addTo(map).bindPopup("St Andrews Botanic Garden")  // Marker for St Andrews botanic


  // store markers by category
  // var markersByCategory = {
  //   'beach': [westSandsMarker, eastSandsMarker, castleSandsMarker],
  //   'food': [adamsonMarker, toastieMarker, forganMarker],
  //   'sport': [linksMarker, golfMarker],
  //   'museum': [trustMarker, castleMarker]

  // }

      /* event listener for category cards
      var beachCard = document.querySelector('.beach-card');
      beachCard.addEventListener('click', function () {
        filterMarkers('beach');
      })
    */


    </script>

    <script>
      // connect to weather api
      function queryWeather(address) {
        const apiKey = '2654d06e65bd3dc4726713a79c4254bb';
        // const query = 'St-Andrews';
        const query = document.getElementById("location").value;
        const apiUrl = `http://api.weatherstack.com/current?access_key=${apiKey}&query=${address ? address : query}`;

        fetch(apiUrl)
          .then(response => response.json())
          .then(data => {
            console.log(data)
            const location = data.location.name;
            const temperature = data.current.temperature;
            const description = data.current.weather_descriptions[0];
            window.alert("temperature:" + temperature)
            const weatherInfo = `It is currently ${temperature} degrees Celsius and ${description} in ${location}.`;

          })
          .catch(error => {
            console.error('Error fetching weather data:', error);
          })
      }
    </script>
    <script>

      const map = L.map('map').setView([51.505, -0.09], 13);

      const tiles = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
      }).addTo(map);



      const popup = L.popup()

      function onMapClick(e) {
        console.log(e.latlng);
        popup
          .setLatLng(e.latlng)
          .setContent(`You clicked the map at ${e.latlng.toString()}`)
          .openOn(map);

        const apiKey = '2654d06e65bd3dc4726713a79c4254bb';
        const apiUrl = `http://api.weatherstack.com/current?access_key=${apiKey}&query=${e.latlng.lat},${e.latlng.lng}`;

        fetch(apiUrl)
          .then(response => response.json())
          .then(data => {
            const location = data.location.name;
            const temperature = data.current.temperature;
            const description = data.current.weather_descriptions[0];
            const weatherInfo = `It is currently ${temperature} degrees Celsius and ${description} in ${location}.`;
            alert(weatherInfo)
          })
          .catch(error => {
            console.error('Error fetching weather data:', error);
          })
      }

      map.on('click', onMapClick);

    </script>
</body>

</html>